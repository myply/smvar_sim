import torch.nn as nn
import torch
from functions import Slice
@torch.no_grad()
def yolov5():
    layer0input=torch.zeros(1,3,192,320).detach()
    layer0output=Slice().forward(layer0input)
    layer1output=nn.Conv2d(in_channels=12,out_channels=32,kernel_size=3,stride=1,padding=1).forward(layer0output)
    layer2output=nn.SiLU().forward(layer1output)
    layer3output=nn.Conv2d(in_channels=32,out_channels=64,kernel_size=3,stride=2,padding=1).forward(layer2output)
    layer4output=nn.SiLU().forward(layer3output)
    layer5output=nn.Conv2d(in_channels=64,out_channels=32,kernel_size=1,stride=1,padding=0).forward(layer4output)
    layer6output=nn.SiLU().forward(layer5output)
    layer7output=nn.Conv2d(in_channels=32,out_channels=32,kernel_size=1,stride=1,padding=0).forward(layer6output)
    layer8output=nn.SiLU().forward(layer7output)
    layer9output=nn.Conv2d(in_channels=32,out_channels=32,kernel_size=3,stride=1,padding=1).forward(layer8output)
    layer10output=nn.SiLU().forward(layer9output)
    layer11output=layer6output+layer10output
    layer12output=nn.Conv2d(in_channels=64,out_channels=32,kernel_size=1,stride=1,padding=0).forward(layer4output)
    layer13output=nn.SiLU().forward(layer12output)
    layer14output=torch.cat((layer11output,layer13output),1)
    layer15output=nn.Conv2d(in_channels=64,out_channels=64,kernel_size=1,stride=1,padding=0).forward(layer14output)
    layer16output=nn.SiLU().forward(layer15output)
    layer17output=nn.Conv2d(in_channels=64,out_channels=128,kernel_size=3,stride=2,padding=1).forward(layer16output)
    layer18output=nn.SiLU().forward(layer17output)
    layer19output=nn.Conv2d(in_channels=128,out_channels=64,kernel_size=1,stride=1,padding=0).forward(layer18output)
    layer20output=nn.SiLU().forward(layer19output)
    layer21output=nn.Conv2d(in_channels=64,out_channels=64,kernel_size=1,stride=1,padding=0).forward(layer20output)
    layer22output=nn.SiLU().forward(layer21output)
    layer23output=nn.Conv2d(in_channels=64,out_channels=64,kernel_size=3,stride=1,padding=1).forward(layer22output)
    layer24output=nn.SiLU().forward(layer23output)
    layer25output=layer20output+layer24output
    layer26output=nn.Conv2d(in_channels=64,out_channels=64,kernel_size=1,stride=1,padding=0).forward(layer25output)
    layer27output=nn.SiLU().forward(layer26output)
    layer28output=nn.Conv2d(in_channels=64,out_channels=64,kernel_size=3,stride=1,padding=1).forward(layer27output)
    layer29output=nn.SiLU().forward(layer28output)
    layer30output=layer25output+layer29output
    layer31output=nn.Conv2d(in_channels=64,out_channels=64,kernel_size=1,stride=1,padding=0).forward(layer30output)
    layer32output=nn.SiLU().forward(layer31output)
    layer33output=nn.Conv2d(in_channels=64,out_channels=64,kernel_size=3,stride=1,padding=1).forward(layer32output)
    layer34output=nn.SiLU().forward(layer33output)
    layer35output=layer30output+layer34output
    layer36output=nn.Conv2d(in_channels=128,out_channels=64,kernel_size=1,stride=1,padding=0).forward(layer18output)
    layer37output=nn.SiLU().forward(layer36output)
    layer38output=torch.cat((layer35output,layer37output),1)
    layer39output=nn.Conv2d(in_channels=128,out_channels=128,kernel_size=1,stride=1,padding=0).forward(layer38output)
    layer40output=nn.SiLU().forward(layer39output)
    layer41output=nn.Conv2d(in_channels=128,out_channels=256,kernel_size=3,stride=2,padding=1).forward(layer40output)
    layer42output=nn.SiLU().forward(layer41output)
    layer43output=nn.Conv2d(in_channels=256,out_channels=128,kernel_size=1,stride=1,padding=0).forward(layer42output)
    layer44output=nn.SiLU().forward(layer43output)
    layer45output=nn.Conv2d(in_channels=128,out_channels=128,kernel_size=1,stride=1,padding=0).forward(layer44output)
    layer46output=nn.SiLU().forward(layer45output)
    layer47output=nn.Conv2d(in_channels=128,out_channels=128,kernel_size=3,stride=1,padding=1).forward(layer46output)
    layer48output=nn.SiLU().forward(layer47output)
    layer49output=layer44output+layer48output
    layer50output=nn.Conv2d(in_channels=128,out_channels=128,kernel_size=1,stride=1,padding=0).forward(layer49output)
    layer51output=nn.SiLU().forward(layer50output)
    layer52output=nn.Conv2d(in_channels=128,out_channels=128,kernel_size=3,stride=1,padding=1).forward(layer51output)
    layer53output=nn.SiLU().forward(layer52output)
    layer54output=layer49output+layer53output
    layer55output=nn.Conv2d(in_channels=128,out_channels=128,kernel_size=1,stride=1,padding=0).forward(layer54output)
    layer56output=nn.SiLU().forward(layer55output)
    layer57output=nn.Conv2d(in_channels=128,out_channels=128,kernel_size=3,stride=1,padding=1).forward(layer56output)
    layer58output=nn.SiLU().forward(layer57output)
    layer59output=layer54output+layer58output
    layer60output=nn.Conv2d(in_channels=256,out_channels=128,kernel_size=1,stride=1,padding=0).forward(layer42output)
    layer61output=nn.SiLU().forward(layer60output)
    layer62output=torch.cat((layer59output,layer61output),1)
    layer63output=nn.Conv2d(in_channels=256,out_channels=256,kernel_size=1,stride=1,padding=0).forward(layer62output)
    layer64output=nn.SiLU().forward(layer63output)
    layer65output=nn.Conv2d(in_channels=256,out_channels=512,kernel_size=3,stride=2,padding=1).forward(layer64output)
    layer66output=nn.SiLU().forward(layer65output)
    layer67output=nn.Conv2d(in_channels=512,out_channels=256,kernel_size=1,stride=1,padding=0).forward(layer66output)
    layer68output=nn.SiLU().forward(layer67output)
    layer69output=nn.MaxPool2d(kernel_size=5, stride=1, padding=2).forward(layer68output)
    layer70output=nn.MaxPool2d(kernel_size=9, stride=1, padding=4).forward(layer68output)
    layer71output=nn.MaxPool2d(kernel_size=13, stride=1, padding=6).forward(layer68output)
    layer72output=torch.cat((layer68output,layer69output,layer70output,layer71output),1)
    layer73output=nn.Conv2d(in_channels=1024,out_channels=512,kernel_size=1,stride=1,padding=0).forward(layer72output)
    layer74output=nn.SiLU().forward(layer73output)
    layer75output=nn.Conv2d(in_channels=512,out_channels=256,kernel_size=1,stride=1,padding=0).forward(layer74output)
    layer76output=nn.SiLU().forward(layer75output)
    layer77output=nn.Conv2d(in_channels=256,out_channels=256,kernel_size=1,stride=1,padding=0).forward(layer76output)
    layer78output=nn.SiLU().forward(layer77output)
    layer79output=nn.Conv2d(in_channels=256,out_channels=256,kernel_size=3,stride=1,padding=1).forward(layer78output)
    layer80output=nn.SiLU().forward(layer79output)
    layer81output=nn.Conv2d(in_channels=512,out_channels=256,kernel_size=1,stride=1,padding=0).forward(layer74output)
    layer82output=nn.SiLU().forward(layer81output)
    layer83output=torch.cat((layer80output,layer82output),1)
    layer84output=nn.Conv2d(in_channels=512,out_channels=512,kernel_size=1,stride=1,padding=0).forward(layer83output)
    layer85output=nn.SiLU().forward(layer84output)
    layer86output=nn.Conv2d(in_channels=512,out_channels=256,kernel_size=1,stride=1,padding=0).forward(layer85output)
    layer87output=nn.SiLU().forward(layer86output)
    layer88output=nn.Upsample(size=None, scale_factor=2, mode='nearest').forward(layer87output)
    layer89output=torch.cat((layer88output,layer64output),1)
    layer90output=nn.Conv2d(in_channels=512,out_channels=128,kernel_size=1,stride=1,padding=0).forward(layer89output)
    layer91output=nn.SiLU().forward(layer90output)
    layer92output=nn.Conv2d(in_channels=128,out_channels=128,kernel_size=1,stride=1,padding=0).forward(layer91output)
    layer93output=nn.SiLU().forward(layer92output)
    layer94output=nn.Conv2d(in_channels=128,out_channels=128,kernel_size=3,stride=1,padding=1).forward(layer93output)
    layer95output=nn.SiLU().forward(layer94output)
    layer96output=nn.Conv2d(in_channels=512,out_channels=128,kernel_size=1,stride=1,padding=0).forward(layer89output)
    layer97output=nn.SiLU().forward(layer96output)
    layer98output=torch.cat((layer95output,layer97output),1)
    layer99output=nn.Conv2d(in_channels=256,out_channels=256,kernel_size=1,stride=1,padding=0).forward(layer98output)
    layer100output=nn.SiLU().forward(layer99output)
    layer101output=nn.Conv2d(in_channels=256,out_channels=128,kernel_size=1,stride=1,padding=0).forward(layer100output)
    layer102output=nn.SiLU().forward(layer101output)
    layer103output=nn.Upsample(size=None, scale_factor=2, mode='nearest').forward(layer102output)
    layer104output=torch.cat((layer103output,layer40output),1)
    layer105output=nn.Conv2d(in_channels=256,out_channels=64,kernel_size=1,stride=1,padding=0).forward(layer104output)
    layer106output=nn.SiLU().forward(layer105output)
    layer107output=nn.Conv2d(in_channels=64,out_channels=64,kernel_size=1,stride=1,padding=0).forward(layer106output)
    layer108output=nn.SiLU().forward(layer107output)
    layer109output=nn.Conv2d(in_channels=64,out_channels=64,kernel_size=3,stride=1,padding=1).forward(layer108output)
    layer110output=nn.SiLU().forward(layer109output)
    layer111output=nn.Conv2d(in_channels=256,out_channels=64,kernel_size=1,stride=1,padding=0).forward(layer104output)
    layer112output=nn.SiLU().forward(layer111output)
    layer113output=torch.cat((layer110output,layer112output),1)
    layer114output=nn.Conv2d(in_channels=128,out_channels=128,kernel_size=1,stride=1,padding=0).forward(layer113output)
    layer115output=nn.SiLU().forward(layer114output)
    layer116output=nn.Conv2d(in_channels=128,out_channels=128,kernel_size=3,stride=2,padding=1).forward(layer115output)
    layer117output=nn.SiLU().forward(layer116output)
    layer118output=torch.cat((layer117output,layer102output),1)
    layer119output=nn.Conv2d(in_channels=256,out_channels=128,kernel_size=1,stride=1,padding=0).forward(layer118output)
    layer120output=nn.SiLU().forward(layer119output)
    layer121output=nn.Conv2d(in_channels=128,out_channels=128,kernel_size=1,stride=1,padding=0).forward(layer120output)
    layer122output=nn.SiLU().forward(layer121output)
    layer123output=nn.Conv2d(in_channels=128,out_channels=128,kernel_size=3,stride=1,padding=1).forward(layer122output)
    layer124output=nn.SiLU().forward(layer123output)
    layer125output=nn.Conv2d(in_channels=256,out_channels=128,kernel_size=1,stride=1,padding=0).forward(layer118output)
    layer126output=nn.SiLU().forward(layer125output)
    layer127output=torch.cat((layer124output,layer126output),1)
    layer128output=nn.Conv2d(in_channels=256,out_channels=256,kernel_size=1,stride=1,padding=0).forward(layer127output)
    layer129output=nn.SiLU().forward(layer128output)
    layer130output=nn.Conv2d(in_channels=256,out_channels=256,kernel_size=3,stride=2,padding=1).forward(layer129output)
    layer131output=nn.SiLU().forward(layer130output)
    layer132output=torch.cat((layer131output,layer87output),1)
    layer133output=nn.Conv2d(in_channels=512,out_channels=256,kernel_size=1,stride=1,padding=0).forward(layer132output)
    layer134output=nn.SiLU().forward(layer133output)
    layer135output=nn.Conv2d(in_channels=256,out_channels=256,kernel_size=1,stride=1,padding=0).forward(layer134output)
    layer136output=nn.SiLU().forward(layer135output)
    layer137output=nn.Conv2d(in_channels=256,out_channels=256,kernel_size=3,stride=1,padding=1).forward(layer136output)
    layer138output=nn.SiLU().forward(layer137output)
    layer139output=nn.Conv2d(in_channels=512,out_channels=256,kernel_size=1,stride=1,padding=0).forward(layer132output)
    layer140output=nn.SiLU().forward(layer139output)
    layer141output=torch.cat((layer138output,layer140output),1)
    layer142output=nn.Conv2d(in_channels=512,out_channels=512,kernel_size=1,stride=1,padding=0).forward(layer141output)
    layer143output=nn.SiLU().forward(layer142output)
    layer144output=nn.Conv2d(in_channels=128,out_channels=27,kernel_size=1,stride=1,padding=0).forward(layer115output)
    layer145output=nn.Conv2d(in_channels=256,out_channels=27,kernel_size=1,stride=1,padding=0).forward(layer129output)
    layer146output=nn.Conv2d(in_channels=512,out_channels=27,kernel_size=1,stride=1,padding=0).forward(layer143output)
    print(layer144output.shape)
    print(layer145output.shape)
    print(layer146output.shape)
yolov5()
